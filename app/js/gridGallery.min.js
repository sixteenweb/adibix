/* ======================================================= 
 * Grid Responsive Gallery
 * By David Blanco
 *
 * Contact: http://codecanyon.net/user/davidbo90
 *
 * Created: June 26, 2013
 *
 * Copyright (c) 2013, David Blanco. All rights reserved.
 * Released under CodeCanyon License http://codecanyon.net/
 *
 * Note: Script based in jQuery Masonry v2.1.07 made by David DeSandro http://masonry.desandro.com/ (under MIT)
 *
 * ======================================================= */


(function(e,f,g){var b=f.event,a=f.event.handle?"handle":"dispatch",d;b.special.smartresize={setup:function(){f(this).bind("resize",b.special.smartresize.handler)},teardown:function(){f(this).unbind("resize",b.special.smartresize.handler)},handler:function(k,h){var j=this,i=arguments;k.type="smartresize";if(d){clearTimeout(d)}d=setTimeout(function(){b[a].apply(j,i)},h==="execAsap"?0:100)}};f.fn.smartresize=function(h){return h?this.bind("smartresize",h):this.trigger("smartresize",["execAsap"])};f.Gri=function(h,i){this.element=f(i);this._create(h);this._init()};f.Gri.settings={isResizable:true,isAnimated:false,animationOptions:{queue:false,duration:500},gutterWidth:0,isRTL:false,isFitWidth:false,containerStyle:{position:"relative"}};f.Gri.prototype={_filterFindBricks:function(i){var h=this.options.itemSelector;return !h?i:i.filter(h).add(i.find(h))},_getBricks:function(i){var h=this._filterFindBricks(i).css({position:"absolute"}).addClass("grid-brick");return h},_create:function(k){this.options=f.extend(true,{},f.Gri.settings,k);this.styleQueue=[];var j=this.element[0].style;this.originalStyle={height:j.height||""};var l=this.options.containerStyle;for(var n in l){this.originalStyle[n]=j[n]||""}this.element.css(l);this.horizontalDirection=this.options.isRTL?"right":"left";var i=this.element.css("padding-"+this.horizontalDirection);var m=this.element.css("padding-top");this.offset={x:i?parseInt(i,10):0,y:m?parseInt(m,10):0};this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth==="function";var h=this;setTimeout(function(){h.element.addClass("grid")},0);if(this.options.isResizable){f(e).bind("smartresize.grid",function(){h.resize()})}this.reloadItems()},_init:function(h){this._getColumns();this._reLayout(h)},option:function(h,i){if(f.isPlainObject(h)){this.options=f.extend(true,this.options,h)}},layout:function(p,q){for(var n=0,o=p.length;n<o;n++){this._placeBrick(p[n])}var h={};h.height=Math.max.apply(Math,this.colYs);if(this.options.isFitWidth){var l=0;n=this.cols;while(--n){if(this.colYs[n]!==0){break}l++}h.width=(this.cols-l)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:h});var j=!this.isLaidOut?"css":(this.options.isAnimated?"animate":"css"),k=this.options.animationOptions;var m;for(n=0,o=this.styleQueue.length;n<o;n++){m=this.styleQueue[n];m.$el[j](m.style,k)}this.styleQueue=[];if(q){q.call(p)}this.isLaidOut=true},_getColumns:function(){var h=this.options.isFitWidth?this.element.parent():this.element,i=h.width();this.columnWidth=this.isFluid?this.options.columnWidth(i):this.options.columnWidth||this.$bricks.outerWidth(true)||i;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((i+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},_placeBrick:function(q){var o=f(q),s,w,l,u,m;s=Math.ceil(o.outerWidth(true)/this.columnWidth);s=Math.min(s,this.cols);if(s===1){l=this.colYs}else{w=this.cols+1-s;l=[];for(m=0;m<w;m++){u=this.colYs.slice(m,m+s);l[m]=Math.max.apply(Math,u)}}var h=Math.min.apply(Math,l),v=0;for(var n=0,r=l.length;n<r;n++){if(l[n]===h){v=n;break}}var p={top:h+this.offset.y};p[this.horizontalDirection]=this.columnWidth*v+this.offset.x;this.styleQueue.push({$el:o,style:p});var t=h+o.outerHeight(true),k=this.cols+1-r;for(n=0;n<k;n++){this.colYs[v+n]=t}},resize:function(){var h=this.cols;this._getColumns();if(this.isFluid||this.cols!==h){this._reLayout()}},_reLayout:function(j){var h=this.cols;this.colYs=[];while(h--){this.colYs.push(0)}this.layout(this.$bricks,j)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(h){this.reloadItems();this._init(h)},appended:function(i,k,l){var j=this.element.width();this.options.columnWidth(j);if(k){this._filterFindBricks(i).css({top:this.element.height()});var h=this;setTimeout(function(){h._appended(i,l)},1)}else{this._appended(i,l)}},_appended:function(h,j){var i=this._getBricks(h);this.$bricks=this.$bricks.add(i);this.layout(i,j)},remove:function(h){this.$bricks=this.$bricks.not(h);h.remove()},destroy:function(){this.$bricks.removeClass("grid-brick").each(function(){this.style.position="";this.style.top="";this.style.left=""});var h=this.element[0].style;for(var i in this.originalStyle){h[i]=this.originalStyle[i]}this.element.unbind(".grid").removeClass("grid").removeData("grid");f(e).unbind(".grid")}};
/*!
   * jQuery imagesLoaded plugin v1.1.0
   * http://github.com/desandro/imagesloaded
   *
   * MIT License. by Paul Irish et al.
   */
;f.fn.imagesLoaded=function(o){var m=this,k=m.children().children("img").add(m.filter("img")),h=k.length,n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",j=[];function l(){o.call(m,k)}function i(q){var p=q.target;if(p.src!==n&&f.inArray(p,j)===-1){j.push(p);if(--h<=0){setTimeout(l);k.unbind(".imagesLoaded",i)}}}if(!h){l()}k.bind("load.imagesLoaded error.imagesLoaded",i).each(function(){var p=this.src;this.src=n;this.src=p});return m};var c=function(h){if(e.console){e.console.error(h)}};f.fn.grid=function(i){var j=function(y){var F=f.extend({},f.fn.grid.defaults,i);if(i==g){i={}}i.isFitWidth=F.isFitWidth;i.isAnimated=F.isAnimated;i.itemSelector=".box";i.gutterWidth=F.horizontalSpaceBetweenThumbnails;var t=f(y).addClass("centered").addClass("grid-clearfix");var m=F.columnWidth;if(m=="auto"){i.columnWidth=function(av){var aw=-999;for(var au=F.columns;au>=1;au--){if(aw<F.columnMinWidth){aw=(((av-(au-1)*i.gutterWidth)/au)|0)}}t.find("div.box").width(aw);return aw}}else{if((typeof m)!="function"){i.columnWidth=function(au){var av=m;t.find("div.box").width(av);return av}}}t.find("div.box").css("margin-bottom",F.verticalSpaceBetweenThumbnails);var ab=t.find(".box");var w=Array();function Z(av,au){this.category=av;this.index=au}ab.each(function(av){y=f(this);var au=y.data("category");if(au==g){au="all"}var aw=new Z(au,av);w.push(aw)});var L=Array();for(var u in w){var o=w[u];if(o.category=="all"){continue}var x=false;for(var an=0;an<L.length;an++){if(L[an]==o.category){x=true}}if(x==false){L.push(o.category)}}var E=f('<ul class="category-navbar" />').hide().insertBefore(t);var K=f("<li />").data("category","all").appendTo(E).addClass("select");var K=f("<a />").html("All").appendTo(K);for(var an=0;an<L.length;an++){var K=f("<li />").data("category",L[an]).appendTo(E);var K=f("<a />").html(L[an]).appendTo(K)}E.on("click","a",function(au){au.preventDefault();var ax=jQuery(this);if(ax.parent("li").hasClass("select")){return}ax.parent("li").addClass("select").siblings("li").removeClass("select");var aw=t;var av=ax.parent("li").data("category");if(av=="all"){aw.children('div[data-show="yes"]').show().addClass("box grid-brick").css({top:200,left:200})}else{aw.children('div[data-category="'+av+'"][data-show="yes"]').show().addClass("box grid-brick").css({top:200,left:200});aw.children("div").not('.box[data-category="'+av+'"]').removeClass("box grid-brick").hide()}t.grid("reload");v(r(ak()))});if(typeof L!="object"||L.length==0||F.showFilterBar==false){}else{E.slideDown(400)}var ao=f("<div />").insertAfter(t);var P=false;var J=function(){ao.addClass("grid-loader").removeClass("grid-loadMore").html("")};var T=function(){ao.removeClass("grid-loader")};var v=function(au){if(au){ao.addClass("grid-loadMore").html("LOAD MORE IMAGES")}else{ao.removeClass("grid-loadMore").html("")}};var r=function(aw){var au=0;for(var av in w){if(aw=="all"){au++}else{var ax=w[av];if(ax.category==aw){au++}}}if(au>0){P=false;return true}else{return false}};var ak=function(){var au=E.find("li[class=select]").data("category");return au};var k=function(){var au=ak();if(au!="all"){t.children("div").not('.box[data-category="'+au+'"]').removeClass("box grid-brick").hide()}};var ar=function(aw){var aB=ak();J();var aC=0;var az=f.extend({},w);for(var ay in az){var ax=az[ay];if(aB=="all"){}else{if(aB!=ax.category){continue}}aC++;if(aC>aw){break}y=ab.eq(ax.index);y.addClass("box grid-brick").attr("data-show","yes").hide().css({top:200,left:200});var au=y.find("div[data-thumbnail]").data("thumbnail");var av=y.find("div[data-image]").data("image");if(au==g){au=av}if(av==g){av=au}var aA=f('<img src="'+au+'" data-lightbox="'+av+'" />');y.prepend(aA);delete w[ay]}t.imagesLoaded(function(){ab.filter(":hidden").css({top:200,left:200}).show();k();P=false;T();v(r(ak()));t.grid("reload")})};ab.removeClass("box grid-brick").hide();ab.attr("data-show","no");ar(F.imagesToLoadStart);var am=function(){if(ao.hasClass("grid-loadMore")){ar(F.imagesToLoad)}};ao.on("click",function(){am()});if(F.lazyLoad){f(e).scroll(function(){if(ao.closest("html").length){if((f(e).scrollTop()==(f(document).height()-f(e)[0].innerHeight))&&P==false){P=true;am()}}})}t.on("mouseenter.hoverdir, mouseleave.hoverdir","div.box",function(az){if(!F.caption){return}var ax=f(this),ay=az.type,aw=ax.find("div.thumbnail-caption"),aA=n(ax,{x:az.pageX,y:az.pageY}),av=ah(aA,ax);var aB=aw.children("div.aligment");if(aB[0]==g){var au=aw.html();aw.html("<div class='aligment'><div class='aligment'>"+au+"</div></div>")}if(ay==="mouseenter"){if(F.captionType=="classic"){aw.css({left:0,top:0});aw.fadeIn(300);return}aw.css({left:av.from,top:av.to});aw.stop().show().fadeTo(0,1,function(){f(this).stop().animate({top:0,left:0},200,"linear")})}else{if(F.captionType=="classic"){aw.css({left:0,top:0});aw.fadeOut(300);return}if(F.captionType=="grid-fade"){aw.fadeOut(700)}else{aw.stop().animate({left:av.from,top:av.to},200,"linear",function(){aw.hide()})}}});var n=function(aw,az){var av=aw.width(),ax=aw.height(),au=(az.x-aw.offset().left-(av/2))*(av>ax?(ax/av):1),aA=(az.y-aw.offset().top-(ax/2))*(ax>av?(av/ax):1),ay=Math.round((((Math.atan2(aA,au)*(180/Math.PI))+180)/90)+3)%4;return ay};var ah=function(aw,av){var ax,au;switch(aw){case 0:if(!F.reverse){ax=0,au=-av.height()}else{ax=0,au=-av.height()}break;case 1:if(!F.reverse){ax=av.width(),au=0}else{ax=-av.width(),au=0}break;case 2:if(!F.reverse){ax=0,au=av.height()}else{ax=0,au=-av.height()}break;case 3:if(!F.reverse){ax=-av.width(),au=0}else{ax=av.width(),au=0}break}return{from:ax,to:au}};var W=f("body");var af={interval:"none"};var q=0;var Q=f('<div class="autoGrid-lightbox" />').appendTo(W);var V=f('<div class="autoGrid-nav" />').appendTo(Q);var Y=f('<div class="autoGrid-close" />').appendTo(V);var U=f('<i class="iconClose" />').appendTo(Y);var A=f('<div class="autoGrid-play" />');if(F.lightboxPlayBtn){A.appendTo(V)}var G=f('<i class="iconPlay" />').appendTo(A);var ad=f('<div class="autoGrid-lbcaption" />').appendTo(V).html("Here will go the text for the lightbox");var ai=f('<div class="autoGrid-next" />').appendTo(V);var aq=f('<i class="iconNext" />').appendTo(ai);var D=f('<div class="autoGrid-prev" />').appendTo(V);var I=f('<i class="iconPrev" />').appendTo(D);var ac=f('<div class="lightbox-timer" />').appendTo(Q);var s=Y.width();var X=3;if(F.lightboxPlayBtn){X=4}var l=function(){var aw=Q.outerWidth();if(aw<650){ad.hide();ai.css("width",(aw/X));D.css("width",(aw/X));A.css("width",(aw/X));Y.css("width",aw-((aw/X)*(X-1)))}else{ad.show();ai.css("width",s);D.css("width",s);A.css("width",s);Y.css("width",s)}var au=Q.find("img");var av=Q.outerHeight()-V.outerHeight()-10;au.css("max-height",av)};jQuery(e).resize(function(){l()});var S=new Image();var al=function(){S.onload=null;S=null;Q.find("img").remove()};var N=function(){Q.find(".lb-loader").remove()};var C=function(){Q.append('<div class="lb-loader"/>')};Q.attr("unselectable","on").css("user-select","none").on("selectstart",false);var M=function(){ac.stop(true,true).width(0)};var ap=function(){clearInterval(af.interval)};var B=function(){if(F.lightBoxShowTimer==false){return}ac.css({position:"absolute",bottom:0}).animate({width:"100%"},F.lightBoxPlayInterval,"linear",function(){M()})};var at=false;var aa=false;var O=function(){af.interval=setTimeout(function(){p()},F.lightBoxPlayInterval);B()};var z=function(){if(at&&aa==false){M();ap();O()}};var ag=f("<span />");var H=function(aA,av){al();N();C();var ay=0;var az=0;if(av!=true){ay=0.9;az=F.lightBoxSpeedFx}if(F.lightBoxZoomAnim==false){ay=1}var aw=aA;var ax=aw.data("lightbox");if(ax==g){ax=aw.attr("src")}var aD=aw.siblings("div.lightbox-text").html();if(F.lightBoxText==false){aD=""}var aC="<div><div>"+aD+"</div></div>";ad.html(aC);S=new Image();var au=f(S);var aB=S;S.onload=function(){if(aB!=S){return}N();Q.append(au.hide().scale(ay));au.fadeIn(az).animate({scale:"1"},{duration:F.lightBoxSpeedFx,complete:function(){z()}});l()};S.src=ax;ag.stop(true);ag=f(S)};var aj=false;t.on("click","div.box",function(){aj=true;var aw=f(this);var av=aw.data("url");if(av!=g){location.href=av;return}if(F.lightBox==false){return}aa=false;q=t.find(".box").index(this);var au=aw.children("img");V.animate({"margin-top":0},F.lightBoxSpeedFx);Q.fadeIn(F.lightBoxSpeedFx);H(au,true)});Q.on("click","div",function(au){au.stopPropagation()});Q.on("click","img",function(au){au.stopPropagation()});Q.on("click",function(){ae()});Y.on("click",function(){ae()});var ae=function(){if(F.lightBoxStopPlayOnClose){A.removeClass("selected");at=false}aj=false;aa=true;M();ap();Q.find(".lb-loader").remove();var av=0;if(F.lightBoxZoomAnim==false){av=1}var au=Q.find("img").stop().show();V.animate({"margin-top":-V.outerHeight()},F.lightBoxSpeedFx);if(au[0]!=g){au.animate({scale:av},F.lightBoxSpeedFx,function(){Q.fadeOut(100)})}else{Q.fadeOut(100)}};var p=function(){aa=false;var ax=t.find(".box");q+=1;if(q>=ax.length){q=0}if(!ax.eq(q).is(":visible")){var au=q;for(var aw=0;aw<ax.length;aw++){au++;if(au>=ax.length){au=0}if(ax.eq(au).is(":visible")){q=au;break}}}var av=ax.eq(q).children("img");H(av)};var R=function(){aa=false;var ax=t.find(".box");q-=1;if(q<0){q=ax.length-1}if(!ax.eq(q).is(":visible")){var au=q;for(var aw=0;aw<ax.length;aw++){au--;if(au<0){au=ax.length-1}if(ax.eq(au).is(":visible")){q=au;break}}}var av=ax.eq(q).children("img");H(av)};ai.on("click",function(){M();ap();p()});Q.on("click","img",function(){M();ap();p()});D.on("click",function(){M();ap();R()});f(document).keyup(function(au){if(!F.lightboxKeyboardNav){return}if(au.keyCode=="37"){if(aj==false){return}M();ap();R()}if(au.keyCode=="39"){if(aj==false){return}M();ap();p()}if(au.keyCode==27){ae()}});if(F.lightBoxAutoPlay){A.addClass("selected");at=true}A.on("click",function(){y=f(this);if(y.hasClass("selected")){y.removeClass("selected");at=false;M();ap()}else{y.addClass("selected");at=true;O()}})};if(typeof i==="string"){var h=Array.prototype.slice.call(arguments,1);this.each(function(){var k=f.data(this,"grid");if(!k){c("cannot call methods on grid prior to initialization; attempted to call method '"+i+"'");return}if(!f.isFunction(k[i])||i.charAt(0)==="_"){c("no such method '"+i+"' for grid instance");return}k[i].apply(k,h)})}else{this.each(function(){var k=f.data(this,"grid");if(k){k.option(i||{});k._init()}else{j(this);f.data(this,"grid",new f.Gri(i,this))}})}return this};f.fn.grid.defaults={showFilterBar:true,imagesToLoad:5,imagesToLoadStart:15,lazyLoad:false,isFitWidth:true,horizontalSpaceBetweenThumbnails:5,verticalSpaceBetweenThumbnails:5,columnWidth:"auto",columns:5,columnMinWidth:220,isAnimated:true,caption:true,captionType:"grid",lightBox:true,lightboxKeyboardNav:true,lightBoxSpeedFx:500,lightBoxZoomAnim:true,lightBoxText:true,lightboxPlayBtn:true,lightBoxAutoPlay:false,lightBoxPlayInterval:4000,lightBoxShowTimer:true,lightBoxStopPlayOnClose:false}})(window,jQuery);
